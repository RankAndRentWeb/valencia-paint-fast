---
import Layout from '@/layouts/SiteLayout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('blogs');
  return posts.map(entry => {
    const [category, slug] = entry.slug.split('/');
    return { 
      params: { category, slug }, 
      props: { entry } 
    };
  });
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const { data } = entry;
---

<Layout title={`${data.title} - Blog`} description={data.description ?? data.excerpt}>
  <article class="container mx-auto px-4 py-10 prose lg:prose-lg max-w-3xl">
    <h1 class="!mb-4">{data.title}</h1>
    {data.cover && <img src={data.cover} alt={data.title} class="rounded-xl shadow mb-6" />}
    <Content />
  </article>
</Layout>